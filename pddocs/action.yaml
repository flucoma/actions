name: 'Build FluCoMa Toolkit Docs for PureData'
description: 'Builds the FluCoMa Docs Toolkit for PureData'
inputs:
  branch:
    description: 'Which branch to pull dependencies from (main/dev)'
    required: false
    default: 'dev'
runs:
  using: "composite"
  steps:

    - name: Get PureData Source (Mac/Linux)
      run: git clone https://github.com/pure-data/pure-data.git sdk
      shell: bash

    - name: clone latest flucoma-docs
      run: git clone --branch ${{ inputs.branch }} https://github.com/flucoma/flucoma-docs.git docs
      shell: bash

    - name: install python dependencies
      run: pip3 install -r docs/requirements.txt
      shell: bash

    - name: cmake
      run: cmake -GNinja -DDOCS=ON -DFLUID_PATH=../core -DPD_PATH=../sdk/ ..
      working-directory: build
      shell: bash

    - name: install
      run: ninja MAKE_PD_REF
      working-directory: Build
      shell: bash